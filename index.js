#!/usr/bin/env node\nconst { Command } = require('commander');\nconst licenseChecker = require('license-checker-rseidelsohn');\nconst fs = require('fs');\nconst path = require('path');\nconst puppeteer = require('puppeteer');\n\nconst program = new Command();\nprogram.name('dep-license-auditor').description('Audit NPM deps licenses.');\n\nprogram\n  .argument('[dir]', 'Directory to audit', process.cwd())\n  .option('-l, --license &lt;key&gt;', 'Pro license key (DEMO-PRO)')\n  .option('-f, --format &lt;format&gt;', 'Output format: table|json|csv|pdf', 'table')\n  .option('--production', 'Only production deps')\n  .action(async (dir, cmd) => {\n    const isPro = cmd.license === 'DEMO-PRO';\n    if (!isPro) {\n      console.log('üîì DEMO MODE: Console table only. Buy pro at Gumroad for exports/PDF.');\n    }\n\n    licenseChecker.init({\n      start: dir,\n      production: cmd.production,\n      csv: false,\n      json: true\n    }, async (err, licenses) => {\n      if (err) {\n        console.error('Error:', err);\n        process.exit(1);\n      }\n\n      const pkgs = Object.entries(licenses).map(([pkgId, info]) => {\n        const licenses = Array.isArray(info.licenses) ? info.licenses.join(', ') : info.licenses;\n        const risky = /GPL|AGPL|CPOL|SSPL/i.test(licenses);\n        return {\n          package: pkgId,\n          licenses,\n          publisher: info.publisher || '',\n          repository: info.repository || '',\n          risky: risky ? '‚ö†Ô∏è' : '‚úÖ'\n        };\n      }).sort((a,b) => a.risky.localeCompare(b.risky));\n\n      switch (cmd.format) {\n        case 'table':\n          console.table(pkgs);\n          break;\n        case 'json':\n        case 'csv':\n          if (isPro) {\n            const out = cmd.format === 'json' ? JSON.stringify(pkgs, null, 2) : toCsv(pkgs);\n            fs.writeFileSync(`licenses-${cmd.format}`, out);\n            console.log(`Exported to licenses-${cmd.format}`);\n          } else {\n            console.log('Pro feature');\n          }\n          break;\n        case 'pdf':\n          if (isPro) {\n            await generatePdf(pkgs, dir);\n          } else {\n            console.log('Pro feature');\n          }\n          break;\n      }\n    });\n  });\n\nfunction toCsv(pkgs) {\n  const headers = Object.keys(pkgs[0]);\n  const csv = [headers.join(','), ...pkgs.map(p => headers.map(h => JSON.stringify(p[h])).join(','))].join('\\n');\n  return csv;\n}\n\nasync function generatePdf(pkgs, dir) {\n  const browser = await puppeteer.launch({headless: 'new'});\n  const page = await browser.newPage();\n  const html = `\n    &lt;!DOCTYPE html&gt;\n    &lt;html&gt;\n    &lt;head&gt;&lt;title&gt;License Audit&lt;/title&gt;\n    &lt;style&gt;table {border-collapse: collapse; width:100%;} th,td {border:1px solid #ddd; padding:8px;} tr:nth-child(even){background:#f2f2f2;} .risky {background: #ffebee;}&lt;/style&gt;\n    &lt;/head&gt;\n    &lt;body&gt;\n    &lt;h1&gt;Dependency License Audit: ${dir}&lt;/h1&gt;\n    &lt;table&gt;\n      &lt;tr&gt;&lt;th&gt;Package&lt;/th&gt;&lt;th&gt;Licenses&lt;/th&gt;&lt;th&gt;Publisher&lt;/th&gt;&lt;th&gt;Repo&lt;/th&gt;&lt;th&gt;Risk&lt;/th&gt;&lt;/tr&gt;\n      ${pkgs.map(p => `\n        &lt;tr class=\\'${p.risky === '‚ö†Ô∏è' ? 'risky' : ''}'&gt;\n          &lt;td&gt;${p.package}&lt;/td&gt;\n          &lt;td&gt;${p.licenses}&lt;/td&gt;\n          &lt;td&gt;${p.publisher}&lt;/td&gt;\n          &lt;td&gt;&lt;a href=\\'${p.repository.replace(/^git@/,'https://github.com/').replace(/\\.git$/,'')}'&gt;repo&lt;/a&gt;&lt;/td&gt;\n          &lt;td&gt;${p.risky}&lt;/td&gt;\n        &lt;/tr&gt;\n      `).join('')}\n    &lt;/table&gt;\n    &lt;/body&gt;\n    &lt;/html&gt;`;\n  await page.setContent(html);\n  await page.pdf({path: 'license-audit.pdf', format: 'A4'});\n  await browser.close();\n  console.log('PDF saved: license-audit.pdf');\n}\n\nprogram.parse(process.argv);\n\nif (program.args.length === 0) program.help();